<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>World ID Verificaci√≥n</title>
  <script src="https://unpkg.com/@worldcoin/idkit@0.2.2/dist/idkit.umd.production.min.js"></script>
  <style>
    body {
      background: #111;
      color: #fff;
      font-family: sans-serif;
      text-align: center;
      margin-top: 50px;
    }
    button {
      padding: 10px 20px;
      font-size: 18px;
      border: none;
      border-radius: 8px;
      background: #6c63ff;
      color: white;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Verifica tu identidad con World ID</h1>
  <button id="verificarBtn">Verificar</button>

  <script>
    document.getElementById("verificarBtn").addEventListener("click", () => {
      if (!window.IDKit) {
        alert("‚ùå Error: IDKit no est√° disponible.");
        return;
      }

      const widget = window.IDKit.init({
        app_id: "app_7686f9027d3e3c0b53d987a3caf1e111",
        action: "login",
        signal: "verificacion-wld",
        credential_types: ["orb"],
        verification_level: "device",
        show_modal: true,
        onSuccess: (result) => {
          console.log("‚úÖ Verificado:", result);
          fetch("https://82b7-189-217-220-181.ngrok-free.app/api/verificar", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(result),
          })
          .then(res => res.json())
          .then(data => console.log("üì¨ Backend respondi√≥:", data))
          .catch(err => console.error("‚ùå Error en el POST:", err));
        },
      });

      widget.open();
    });
  </script>
</body>
</html>
