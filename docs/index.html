<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Verifica tu ID con Worldcoin</title>
</head>
<body>
  <h1>Verifica tu identidad con World ID</h1>
  <button id="verificar">Verificar con Worldcoin</button>
  <div id="idkit-container"></div>

  <!-- Usa tu archivo descargado -->
  <script src="./static/js/index.global.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      if (typeof window.IDKitWidget !== "undefined") {
        const widget = window.IDKitWidget.init({
          app_id: "app_7686f9027d3e3c0b53d987a3caf1e111", // Reemplaza por tu app_id real
          action: "charlycoin-login",
          signal: "verificacion-charly4k",
          verification_level: "device",
          container_id: "idkit-container",
          show_modal: true,
          onSuccess: (result) => {
            console.log("‚úÖ Verificaci√≥n exitosa:", result);
            // Aqu√≠ puedes enviar los datos a tu backend
            fetch("https://82b7-189-217-220-181.ngrok-free.app/api/verificar", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(result)
            })
            .then(res => res.json())
            .then(data => console.log("üì¨ Respuesta del backend:", data))
            .catch(err => console.error("‚ùå Error enviando datos:", err));
          }
        });

        document.getElementById("verificar").addEventListener("click", () => {
          widget.open();
        });
      } else {
        console.error("‚ùå IDKit no carg√≥ correctamente.");
      }
    });
  </script>
</body>
</html>
